<!DOCTYPE HTML>
<!--

    Copyright (C) 2011 Everit Kft. (http://www.everit.org)

    Licensed under the Apache License, Version 2.0 (the "License");
    you may not use this file except in compliance with the License.
    You may obtain a copy of the License at

            http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.

-->
<html>

<head>
<meta charset="utf-8">
<title>OSGi Liquibase Bundle</title>
<link rel="icon" type="image/ico" href="http://www.everit.org/fonts/favicon.ico">

<!--    <link rel="stylesheet" type="text/css" href="common/css/base.css">-->
<link href="http://www.everit.org/css/bootstrap.min.css" rel="stylesheet">
<link href="http://www.everit.org/css/docs.min.css" rel="stylesheet">
<link href="http://www.everit.org/css/everit.css" rel="stylesheet">
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push([ '_setAccount', 'UA-15041869-4' ]);
  _gaq.push([ '_setDomainName', 'everit.org' ]);
  _gaq.push([ '_trackPageview' ]);
</script>
</head>

<body class="bs-docs-home" data-spy="scroll" data-target="#affix-nav">
  <a class="sr-only" href="#content">Skip to main content</a>
  <header class="navbar navbar-static-top bs-docs-nav" id="top" role="banner">
    <div class="container">
      <div class="navbar-header">
        <button class="navbar-toggle" type="button" data-toggle="collapse"
          data-target=".bs-navbar-collapse">
          <span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span
            class="icon-bar"></span> <span class="icon-bar"></span>
        </button>
        <a href="#" class="navbar-brand">Index</a>
      </div>
      <nav class="collapse navbar-collapse bs-navbar-collapse" role="navigation">
        <ul class="nav navbar-nav">
          <li><a href="https://github.com/everit-org/osgi-liquibase-bundle" target="_blank">Source</a></li>
          <li><a href="http://www.everit.org/" target="_blank">Community</a></li>
        </ul>
        <ul class="nav navbar-nav navbar-right">
          <li><a href="http://www.everit.biz" target="_blank">Enterprise</a></li>
          <li><a href="http://everitorg.wordpress.com/" target="_blank">Blog</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <div class="bs-docs-masthead everit-header" id="content" role="main">
    <div class="container">
      <span class="bs-docs-booticon bs-docs-booticon-lg bs-docs-booticon-outline"> <img
        class="logo" src="http://www.everit.org/fonts/sbz_e.svg" alt="E">
      </span>
      <p class="lead">OSGi Liquibase Bundle</p>
    </div>
  </div>
  <div class="container">
    <div class="col-md-10">

      <div class="bs-docs-featurette cookbook">
        <h2 id="introduction" class="bs-docs-featurette-title">Introduction</h2>
        <p>A Liquibase bundle that contains extensions from Everit so that Liquibase can be used
          in an OSGi environmnent. When this bundle is used, no other jar of Liquibase should be
          dropped into the OSGi container.</p>
      </div>
      <hr class="featurette-divider">

      <div class="bs-docs-featurette cookbook">
        <h2 id="inclusion_of_changelog_from_other_bundles" class="bs-docs-featurette-title">Inclusion
          of changeLog from other bundles</h2>
        <p>One enhancement of this bundle is that in XML changeLog format it is possible to
          address changeLogs from other bundles.</p>
        <p>To be able to use the OSGi include element, the OSGiResourceAccessor class has to be
          instantiated and passed to the Liquibase object. By default, resources will be searched in
          the bundle containing the changeLog file. However, it is possible to prefix the file path
          with an "eosgi:" prefix. In that case, the parser will search for Bundle wires based on a
          special capability and if it finds an appropriate wire, a bundle switch will be carried
          out during the parsing process. For example, let`s see a case where an include tag is
          defined in the following way:</p>
        <pre class="prettyprint">&lt;include file="eosgi:myApp" /&gt;</pre>
        <p>In this case, the current bundle containing this snippet has to be wired to another
          bundle based on the following capability:</p>
        <pre class="prettyprint">liquibase.schema;name=myApp;resource=/pathToChangelogFile</pre>
        <p>Additional filters may be defined in include tags like this:</p>
        <pre class="prettyprint">&lt;include file="eosgi:myApp;filter:=(version>=2)" /&gt;</pre>
        <p>In this case, the provider bundle will contain something like this in the MANIFEST
          file:</p>
        <pre class="prettyprint">Provide-Capability: liquibase.schema;name=myApp;resource=/path;version=3 </pre>
        <p>Furthermore, the bundle that contains the inclusion must contain a requirement:</p>
        <pre class="prettyprint">Require-Capability: liquibase.schema;filter:=(name=myApp)</pre>
        <p>Please note, that the resource attribute on the provider side is always required! The
          parser will search for the changelog file based on that attribute.</p>
      </div>
      <hr class="featurette-divider">

      <div class="bs-docs-featurette cookbook">
        <h2 id="future_plans" class="bs-docs-featurette-title">Future plans</h2>
        <p>In the future, it is possible that there will be a maven plugin that automatically
          generates Require-Capability entries in MANIFEST if it finds a changelog file in the
          bundle.</p>
      </div>
      <hr class="featurette-divider">
    </div>

    <!--        Affix-->
    <div class="col-md-2 col-sm-0 col-xs-0">
      <nav id="affix-nav">
        <ul class="nav nav-pills nav-stacked everit-affix" data-spy="affix" data-offset-top="350"
          data-offset-bottom="140">
          <li class="active"><a href="#introduction">Introduction</a></li>
          <li><a href="#inclusion_of_changelog_from_other_bundles">Inclusion of changeLog
              from other bundles</a></li>
          <li><a href="#future_plans">Future plans</a></li>
        </ul>
      </nav>
    </div>
  </div>

  <div></div>
  <footer class="bs-docs-footer" role="contentinfo">
    <div class="container">
      <div class="bs-docs-social">
        <ul class="bs-docs-social-buttons">
          <li class="follow-btn "><a href="https://twitter.com/EveritOrg"
            class="twitter-follow-button" data-show-count="true">Follow @EveritOrg</a></li>
          <li class="tweet-btn"><a href="https://twitter.com/share"
            class="twitter-share-button" data-url="http://www.everit.org/">Tweet</a></li>
        </ul>
      </div>
    </div>
  </footer>

  <!-- Bootstrap core JavaScript
================================================== -->
  <!-- Placed at the end of the document so the pages load faster -->
  <script src="http://www.everit.org/js/jquery-2.1.1.min.js"></script>
  <script src="http://www.everit.org/js/bootstrap.min.js"></script>
  <script src="http://www.everit.org/js/everit.js "></script>
  <script type="text/javascript">
      (function() {
        var ga = document.createElement('script');
        ga.type = 'text/javascript';
        ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl'
            : 'http://www')
            + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(ga, s);
      })();
    </script>
  <script src="http://www.everit.org/js/prettify/run_prettify.js"></script>
</body>

</html>
